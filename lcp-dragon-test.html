<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêâ LCP-Gated Terror Dragon Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', system-ui, sans-serif;
            background: #0a0a0a;
            color: white;
            min-height: 100vh;
        }
        
        /* Hero Section - This is our LCP */
        .hero {
            padding: 60px 20px;
            text-align: center;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            min-height: 50vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .hero h1 {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, #00ff7f, #40e0d0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            /* This will be our Largest Contentful Paint */
        }
        
        .hero p {
            font-size: 1.2rem;
            color: #cccccc;
            max-width: 600px;
            margin: 0 auto 2rem;
        }
        
        .hero-cta {
            display: inline-block;
            padding: 12px 24px;
            background: #00ff7f;
            color: black;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .hero-cta:hover {
            transform: translateY(-2px);
        }
        
        /* Performance Monitor */
        .perf-monitor {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #00ff7f;
            border-radius: 8px;
            padding: 15px;
            font-size: 12px;
            font-family: monospace;
            max-width: 300px;
            z-index: 10000;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 2px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .status-waiting { color: #ffd700; }
        .status-measuring { color: #00bfff; }
        .status-good { color: #00ff7f; }
        .status-poor { color: #ff6b6b; }
        
        /* Dragon will be injected here after LCP */
        .dragon-mount-point {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }
        
        /* Content sections */
        .section {
            padding: 60px 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .section h2 {
            color: #00ff7f;
            margin-bottom: 1rem;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .feature-card h3 {
            color: #40e0d0;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- Hero Section - LCP Content -->
    <div class="hero">
        <h1>Frame Economics v2.0</h1>
        <p>Master behavioral psychology and influence with our advanced motion design system. Experience terror-optimized ambient effects that load after your content.</p>
        <a href="#features" class="hero-cta">Explore Features</a>
    </div>
    
    <!-- Performance Monitor -->
    <div class="perf-monitor">
        <h3>‚ö° LCP-Gated Dragon Monitor</h3>
        <div class="metric">
            <span>LCP Status:</span>
            <span id="lcpStatus" class="status-waiting">Waiting...</span>
        </div>
        <div class="metric">
            <span>LCP Time:</span>
            <span id="lcpTime">-</span>
        </div>
        <div class="metric">
            <span>Dragon Status:</span>
            <span id="dragonStatus" class="status-waiting">Waiting for LCP</span>
        </div>
        <div class="metric">
            <span>Mount Delay:</span>
            <span id="mountDelay">-</span>
        </div>
        <div class="metric">
            <span>Total Time to Dragon:</span>
            <span id="totalTime">-</span>
        </div>
        <div class="metric">
            <span>Bundle Impact:</span>
            <span id="bundleImpact" class="status-good">Zero (Lazy)</span>
        </div>
    </div>
    
    <!-- Dragon Mount Point -->
    <div class="dragon-mount-point" id="dragonContainer"></div>
    
    <!-- Content Sections -->
    <div class="section" id="features">
        <h2>üéØ Lighthouse-Safe Terror</h2>
        <p>Our dragon system demonstrates the perfect balance: <strong>LCP ‚â§ 1.8s</strong> for Lighthouse scores, followed by psychological impact that doesn't sacrifice performance.</p>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h3>LCP-Gated Loading</h3>
                <p>Dragon mounts only AFTER Largest Contentful Paint fires, ensuring Lighthouse scores remain 95+.</p>
            </div>
            <div class="feature-card">
                <h3>Adaptive Quality</h3>
                <p>Automatic device detection scales effects: low-end gets basic animations, high-end gets full terror.</p>
            </div>
            <div class="feature-card">
                <h3>Performance Guardrails</h3>
                <p>Tab visibility, battery level, reduced motion, and frame rate monitoring with auto-pause.</p>
            </div>
            <div class="feature-card">
                <h3>Compositor-Only</h3>
                <p>All animations use transform/opacity for GPU acceleration. No layout thrashing.</p>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>üêâ Terror Features</h2>
        <ul style="list-style: none; padding: 0;">
            <li style="margin: 10px 0;">‚ö° Irregular lightning flashes every 18-26s</li>
            <li style="margin: 10px 0;">üëÅÔ∏è Menacing eye glow with pupil dilation</li>
            <li style="margin: 10px 0;">üí® Breathing mist with 14-22s drift patterns</li>
            <li style="margin: 10px 0;">üî• Lightning-synced brightness pings</li>
            <li style="margin: 10px 0;">üé® OKLCH jade colors for perceptual uniformity</li>
            <li style="margin: 10px 0;">‚è∏Ô∏è Respects reduced motion preferences</li>
        </ul>
    </div>

    <script>
        // LCP-Gated Dragon Mounting Simulation
        class LCPDragonDemo {
            constructor() {
                this.lcpTime = null;
                this.mountTime = null;
                this.dragonMounted = false;
                this.startTime = performance.now();
                
                this.initLCPObserver();
                this.startDragonMountProcess();
            }

            initLCPObserver() {
                // Observe LCP
                const observer = new PerformanceObserver((list) => {
                    for (const entry of list.getEntries()) {
                        if (entry.entryType === 'largest-contentful-paint') {
                            this.lcpTime = entry.startTime;
                            this.updateUI();
                            
                            if (!this.dragonMounted) {
                                this.scheduleDragonMount();
                            }
                        }
                    }
                });

                observer.observe({ type: 'largest-contentful-paint', buffered: true });
                
                // Fallback timeout
                setTimeout(() => {
                    if (!this.lcpTime) {
                        this.lcpTime = performance.now() - this.startTime;
                        this.updateUI();
                        this.scheduleDragonMount();
                    }
                }, 2000);
            }

            scheduleDragonMount() {
                const delayMs = 300; // Safety delay after LCP
                
                document.getElementById('dragonStatus').textContent = `Mounting in ${delayMs}ms...`;
                document.getElementById('dragonStatus').className = 'status-measuring';
                
                setTimeout(() => {
                    this.mountDragon();
                }, delayMs);
            }

            mountDragon() {
                this.mountTime = performance.now() - this.startTime;
                this.dragonMounted = true;
                
                // Simulate dragon effects
                const container = document.getElementById('dragonContainer');
                
                // Create atmospheric layer
                const atmosphere = document.createElement('div');
                atmosphere.style.cssText = `
                    position: absolute;
                    top: -10%;
                    left: -10%;
                    width: 120%;
                    height: 120%;
                    background: conic-gradient(from 180deg at 50% 50%, 
                        oklch(65% 0.11 170) 0deg, 
                        oklch(70% 0.15 95) 120deg, 
                        oklch(50% 0.12 170) 240deg, 
                        oklch(65% 0.11 170) 360deg);
                    opacity: 0.12;
                    filter: blur(80px);
                    animation: dragonBreathing 18s ease-in-out infinite;
                `;
                container.appendChild(atmosphere);

                // Create dragon head
                const dragonHead = document.createElement('div');
                dragonHead.style.cssText = `
                    position: absolute;
                    top: 22%;
                    left: 18%;
                    width: 320px;
                    height: 180px;
                    border: 3px solid oklch(65% 0.11 170);
                    border-radius: 45% 35% 85% 15%;
                    background: radial-gradient(ellipse 60% 40% at 40% 35%, oklch(65% 0.11 170)22, transparent 70%);
                    opacity: 0.32;
                    animation: dragonHeadBreathing 16s ease-in-out infinite;
                `;
                
                // Dragon eye
                const eye = document.createElement('div');
                eye.style.cssText = `
                    position: absolute;
                    top: 38%;
                    right: 35%;
                    width: 12px;
                    height: 12px;
                    background: oklch(65% 0.11 170);
                    border-radius: 50%;
                    box-shadow: 0 0 15px oklch(65% 0.11 170);
                    animation: dragonEyeMenace 2.5s ease-in-out infinite;
                `;
                dragonHead.appendChild(eye);
                container.appendChild(dragonHead);

                // Add CSS animations
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes dragonBreathing {
                        0%, 100% { transform: translateY(0) scale(1); opacity: 0.12; }
                        50% { transform: translateY(-1.5%) scale(1.015); opacity: 0.16; }
                    }
                    @keyframes dragonHeadBreathing {
                        0%, 100% { transform: translateY(0) scale(1); }
                        50% { transform: translateY(-0.8%) scale(1.02); }
                    }
                    @keyframes dragonEyeMenace {
                        0% { opacity: 1; transform: scale(1); }
                        15% { opacity: 0.8; transform: scale(0.95); }
                        20% { opacity: 0.2; transform: scale(0.9); }
                        25% { opacity: 1; transform: scale(1); }
                        40% { opacity: 1.2; transform: scale(1.05); }
                        85% { opacity: 1; transform: scale(1); }
                        92% { opacity: 0.3; transform: scale(0.9); }
                        96% { opacity: 1; transform: scale(1); }
                        100% { opacity: 1; transform: scale(1); }
                    }
                    @media (prefers-reduced-motion: reduce) {
                        #dragonContainer * { animation: none !important; }
                    }
                `;
                document.head.appendChild(style);

                // Lightning effect every 20s
                this.startLightningTimer();
                
                this.updateUI();
                console.log('üêâ Terror Dragon mounted successfully after LCP!');
            }

            startLightningTimer() {
                const flash = () => {
                    const lightning = document.createElement('div');
                    lightning.style.cssText = `
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: radial-gradient(circle at ${20 + Math.random() * 60}% ${20 + Math.random() * 60}%, 
                            rgba(255,255,255,0.15) 0%, transparent 50%);
                        mix-blend-mode: screen;
                        pointer-events: none;
                        animation: lightningBurst 0.4s ease-out;
                    `;
                    
                    document.getElementById('dragonContainer').appendChild(lightning);
                    
                    // Remove after animation
                    setTimeout(() => {
                        if (lightning.parentNode) {
                            lightning.parentNode.removeChild(lightning);
                        }
                    }, 400);
                    
                    // Schedule next flash
                    setTimeout(flash, 18000 + Math.random() * 8000);
                };
                
                // Add lightning CSS
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes lightningBurst {
                        0% { opacity: 0; transform: scale(0.8); }
                        10% { opacity: 0.8; transform: scale(1.1); }
                        20% { opacity: 0.4; transform: scale(1); }
                        40% { opacity: 0.6; transform: scale(1.05); }
                        70% { opacity: 0.2; transform: scale(0.95); }
                        100% { opacity: 0; transform: scale(0.9); }
                    }
                `;
                document.head.appendChild(style);
                
                // First flash in 20s
                setTimeout(flash, 20000);
            }

            updateUI() {
                const elements = {
                    lcpStatus: document.getElementById('lcpStatus'),
                    lcpTime: document.getElementById('lcpTime'),
                    dragonStatus: document.getElementById('dragonStatus'),
                    mountDelay: document.getElementById('mountDelay'),
                    totalTime: document.getElementById('totalTime')
                };

                if (this.lcpTime) {
                    elements.lcpStatus.textContent = 'Measured ‚úÖ';
                    elements.lcpStatus.className = 'status-good';
                    elements.lcpTime.textContent = `${Math.round(this.lcpTime)}ms`;
                }

                if (this.dragonMounted) {
                    elements.dragonStatus.textContent = 'Active üêâ';
                    elements.dragonStatus.className = 'status-good';
                    elements.mountDelay.textContent = '300ms';
                    elements.totalTime.textContent = `${Math.round(this.mountTime)}ms`;
                }
            }
        }

        // Initialize demo
        const demo = new LCPDragonDemo();
        
        console.log('üêâ LCP-Gated Terror Dragon Demo loaded!');
        console.log('Watch the performance monitor to see the mounting sequence.');
    </script>
</body>
</html>